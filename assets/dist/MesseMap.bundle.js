!function(){var e={669:function(){window.L.Map.mergeOptions({smoothWheelZoom:!0,smoothSensitivity:1}),window.L.Map.SmoothWheelZoom=window.L.Handler.extend({addHooks:function(){window.L.DomEvent.on(this._map._container,"wheel",this._onWheelScroll,this)},removeHooks:function(){window.L.DomEvent.off(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){this._isWheeling||this._onWheelStart(e),this._onWheeling(e)},_onWheelStart:function(e){var t=this._map;this._isWheeling=!0,this._wheelMousePosition=t.mouseEventToContainerPoint(e),this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),this._wheelStartLatLng=t.containerPointToLatLng(this._wheelMousePosition),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),t._panAnim&&t._panAnim.stop(),this._goalZoom=t.getZoom(),this._prevCenter=t.getCenter(),this._prevZoom=t.getZoom(),this._zoomAnimationId=requestAnimationFrame(this._updateWheelZoom.bind(this))},_onWheeling:function(e){var t=this._map;this._goalZoom=this._goalZoom+.003*window.L.DomEvent.getWheelDelta(e)*t.options.smoothSensitivity,(this._goalZoom<t.getMinZoom()||this._goalZoom>t.getMaxZoom())&&(this._goalZoom=t._limitZoom(this._goalZoom)),this._wheelMousePosition=this._map.mouseEventToContainerPoint(e),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(this._onWheelEnd.bind(this),200),window.L.DomEvent.preventDefault(e),window.L.DomEvent.stopPropagation(e)},_onWheelEnd:function(){this._isWheeling=!1,cancelAnimationFrame(this._zoomAnimationId),this._map._moveEnd(!0)},_updateWheelZoom:function(){var e=this._map;if(e.getCenter().equals(this._prevCenter)&&e.getZoom()==this._prevZoom){this._zoom=e.getZoom()+.3*(this._goalZoom-e.getZoom()),this._zoom=Math.floor(100*this._zoom)/100;var t=this._wheelMousePosition.subtract(this._centerPoint);0===t.x&&0===t.y||("center"===e.options.smoothWheelZoom?this._center=this._startLatLng:this._center=e.unproject(e.project(this._wheelStartLatLng,this._zoom).subtract(t),this._zoom),this._moved||(e._moveStart(!0,!1),this._moved=!0),e._move(this._center,this._zoom),this._prevCenter=e.getCenter(),this._prevZoom=e.getZoom(),this._zoomAnimationId=requestAnimationFrame(this._updateWheelZoom.bind(this)))}}}),window.L.Map.addInitHook("addHandler","smoothWheelZoom",window.L.Map.SmoothWheelZoom)}},t={};function n(o){var l=t[o];if(void 0!==l)return l.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var o={};!function(){"use strict";n.d(o,{default:function(){return m}}),n(669);var e={attribution:'Map tiles by <a href="https://carto.com/attributions">Carto</a> under <a href="http://www.openstreetmap.org/copyright">ODbL</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:"abcd",maxZoom:20},t={attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a> under <a href="http://www.openstreetmap.org/copyright">ODbL</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',minZoom:1,maxZoom:16},l={attribution:'Map tiles by <a href="http://mapiful.com">Mapiful</a> under <a href="http://www.openstreetmap.org/copyright">ODbL</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',minZoom:1,maxZoom:21},a={layers:{OpenStreetMap:window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',minZoom:1,maxZoom:19}),"Imagery (E)":window.L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'Map tiles by <a href="https://www.esri.com/">Esri</a> &mdash; Map data &copy; Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',minZoom:1,maxZoom:18}),"Voyager (C)":window.L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager_nolabels/{z}/{x}/{y}{r}.png",e),"Positron (C)":window.L.tileLayer("https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png",e),"Dark Matter (C)":window.L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png",e),"OldSchool (M)":window.L.tileLayer("https://tiles.mapiful.com/oldschool/{z}/{x}/{y}.png",l),"Nara (M)":window.L.tileLayer("https://tiles.mapiful.com/nara/{z}/{x}/{y}.png",l),"Playroom (M)":window.L.tileLayer("https://tiles.mapiful.com/playroom/{z}/{x}/{y}.png",l),"Orange (M)":window.L.tileLayer("https://tiles.mapiful.com/mother/{z}/{x}/{y}.png",l),"Mono (M)":window.L.tileLayer("https://tiles.mapiful.com/mono/{z}/{x}/{y}.png",l),"Mono Inverted (M)":window.L.tileLayer("https://tiles.mapiful.com/inverted/{z}/{x}/{y}.png",l),"Gold (M)":window.L.tileLayer("https://tiles.mapiful.com/gold/{z}/{x}/{y}.png",l),"Asphalt (M)":window.L.tileLayer("https://tiles.mapiful.com/asphalt/{z}/{x}/{y}.png",l),"Lagoon (M)":window.L.tileLayer("https://tiles.mapiful.com/lagoon/{z}/{x}/{y}.png",l),"Blue (M)":window.L.tileLayer("https://tiles.mapiful.com/blue/{z}/{x}/{y}.png",l),"Sky (M)":window.L.tileLayer("https://tiles.mapiful.com/sky/{z}/{x}/{y}.png",l),"Spring (M)":window.L.tileLayer("https://tiles.mapiful.com/spring/{z}/{x}/{y}.png",l),"Red (M)":window.L.tileLayer("https://tiles.mapiful.com/red/{z}/{x}/{y}.png",l),"Gaia (M)":window.L.tileLayer("https://tiles.mapiful.com/gaia/{z}/{x}/{y}.png",l),"Coral (M)":window.L.tileLayer("https://tiles.mapiful.com/coral/{z}/{x}/{y}.png",l),"Pink (M)":window.L.tileLayer("https://tiles.mapiful.com/valentine/{z}/{x}/{y}.png",l),"Purple (M)":window.L.tileLayer("https://tiles.mapiful.com/lavender/{z}/{x}/{y}.png",l),"Toner (S)":window.L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}{r}.png",t),"Watercolor (S)":window.L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png",t)},overlays:{"Toner Lines (S)":window.L.tileLayer("https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}{r}.png",t)}};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,l=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(l)?l:String(l)),o)}var l}var d=window.jspdf.jsPDF,s=!1,m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._map=null,this._search=null,this._tilesLoaded=!1,this._commentEdited=!1,this._intervalId=-1,this._cssTheme={},this._lang=localStorage.getItem("lang")||"fr",this._nls={},this._initInterface().then(this._initMap.bind(this)).then(this._initEvents.bind(this)).catch((function(e){return console.error(e)}))}var t,n;return t=e,(n=[{key:"_initInterface",value:function(){var e=this;return new Promise((function(t,n){localStorage.getItem("lang")||localStorage.setItem("lang",e._lang),fetch("assets/nls/".concat(e._lang,".json")).then((function(o){o.text().then((function(n){e._nls=JSON.parse(n),e.replaceString(document.body,"{{TITLE}}",e._nls.title),e.replaceString(document.body,"{{ORIENTATION}}",e._nls.orientation),e.replaceString(document.body,"{{VERTICAL}}",e._nls.vertical),e.replaceString(document.body,"{{HORIZONTAL}}",e._nls.horizontal),e.replaceString(document.body,"{{STYLE}}",e._nls.style.title),e.replaceString(document.body,"{{STYLE_STD}}",e._nls.style.std),e.replaceString(document.body,"{{STYLE_TRAVEL}}",e._nls.style.travel),e.replaceString(document.body,"{{STYLE_FRAME}}",e._nls.style.frame),e.replaceString(document.body,"{{STYLE_PURE}}",e._nls.style.pure),e.replaceString(document.body,"{{STYLE_PANTONE}}",e._nls.style.pantone),e.replaceString(document.body,"{{STYLE_MAP}}",e._nls.style.map),e.replaceString(document.body,"{{STYLE_WINDOW}}",e._nls.style.window),e.replaceString(document.body,"{{STYLE_AIR}}",e._nls.style.air),e.replaceString(document.body,"{{STYLE_HIPSTER}}",e._nls.style.hipster),e.replaceString(document.body,"{{DARK_THEME}}",e._nls.style.darkTheme),e.replaceString(document.body,"{{UP_TEXT}}",e._nls.style.upText),e.replaceString(document.body,"{{TEXT}}",e._nls.text.title),e.replaceString(document.body,"{{MAP_TITLE}}",e._nls.text.mapTitle),e.replaceString(document.body,"{{MAP_TITLE_PLACEHOLDER}}",e._nls.text.mapTitlePlaceholder),e.replaceString(document.body,"{{MAP_SUBTITLE}}",e._nls.text.mapSubtitle),e.replaceString(document.body,"{{MAP_SUBTITLE_PLACEHOLDER}}",e._nls.text.mapSubtitlePlaceholder),e.replaceString(document.body,"{{MAP_COMMENT}}",e._nls.text.mapComment),e.replaceString(document.body,"{{MAP_COMMENT_PLACEHOLDER}}",e._nls.text.mapCommentPlaceholder),e.replaceString(document.body,"{{EXPORT}}",e._nls.export.title),e.replaceString(document.body,"{{EXPORT_DIMENSION}}",e._nls.export.dimension),e.replaceString(document.body,"{{EXPORT_AT}}",e._nls.export.at),e.replaceString(document.body,"{{EXPORT_FORMAT}}",e._nls.export.format),e.replaceString(document.body,"{{EXPORT_BUTTON}}",e._nls.export.button),e.replaceString(document.body,"{{CREDITS}}",e._nls.export.credits),e.replaceString(document.body,"{{DOWNLOAD_TITLE}}",e._nls.download.title),e.replaceString(document.body,"{{DOWNLOAD_SUBTITLE}}",e._nls.download.subtitle),t()})).catch(n)})).catch(n)}))}},{key:"_initMap",value:function(){var e=this;return new Promise((function(t,n){try{e._map=window.L.map("map",{attributionControl:!1,zoomSnap:0,scrollWheelZoom:!1,smoothWheelZoom:!0,smoothSensitivity:1}).setView([44.79777779831652,1.542703666063447],5),e._search=new window.L.Control.Search({url:"https://nominatim.openstreetmap.org/search?format=json&q={s}",jsonpParam:"json_callback",propertyName:"display_name",propertyLoc:["lat","lon"],marker:!1,autoCollapse:!0,firstTipSubmit:!0,textPlaceholder:e._nls.search.placeholder,textCancel:e._nls.search.cancel,textErr:e._nls.search.error})}catch(e){return void n(e)}a.layers["Imagery (E)"].addTo(e._map),document.getElementById("map-attribution").innerHTML=a.layers["Imagery (E)"].getAttribution(),window.L.control.layers(a.layers,a.overlays,{position:"topright"}).addTo(e._map),e._map.addControl(e._search),e._applyTexts();var o=localStorage.getItem("theme");o&&JSON.parse(o)&&(e._cssTheme=JSON.parse(o),e.applyThemeColor()),t()}))}},{key:"_initEvents",value:function(){var e=this;return new Promise((function(t){for(var n=document.getElementById("map-orientation"),o=0;o<n.children.length;++o)n.children[o].addEventListener("click",e._updateMapOrientation.bind(e));for(var l=document.getElementById("map-style"),r=0;r<l.children.length;++r)l.children[r].addEventListener("click",e._updateMapStyle.bind(e));for(var i in document.getElementById("dark-theme").addEventListener("change",e._updateDarkTheme.bind(e)),document.getElementById("txt-position").addEventListener("change",e._updateTextPosition.bind(e)),document.getElementById("theme-editor").addEventListener("click",e._themeEditModal.bind(e)),document.getElementById("title-color").addEventListener("input",e._textColorEdit.bind(e)),document.getElementById("subtitle-color").addEventListener("input",e._textColorEdit.bind(e)),document.getElementById("comment-color").addEventListener("input",e._textColorEdit.bind(e)),document.getElementById("modal-overlay").addEventListener("click",e._closeModal.bind(e)),document.getElementById("user-title").addEventListener("input",e._applyTexts.bind(e)),document.getElementById("user-subtitle").addEventListener("input",e._applyTexts.bind(e)),document.getElementById("user-comment").addEventListener("input",e._applyTexts.bind(e)),document.getElementById("image-width").addEventListener("input",e._updateDimensionLabel.bind(e)),document.getElementById("map-save").addEventListener("click",e._download.bind(e)),document.getElementById("credit-modal").addEventListener("click",e._creditModal.bind(e)),a.layers)a.layers[i].on("load",(function(){return setTimeout((function(){return e._tilesLoaded=!0}),4e3)})),a.layers[i].on("add",(function(e){document.getElementById("map-attribution").innerHTML=e.target.getAttribution()}));e._map.on("move",e._updateCommentLabel.bind(e)),e._search.on("search:locationfound",e._searchMatch.bind(e)),t()}))}},{key:"_updateMapOrientation",value:function(e){for(var t=this,n="",o=document.getElementById("map-orientation"),l=0;l<o.children.length;++l)if(o.children[l].classList.contains("selected")){n=o.children[l].dataset.orientation,o.children[l].classList.remove("selected");break}e.target.classList.add("selected"),document.getElementById("map-output").classList.remove("".concat(n)),document.getElementById("map-output").classList.add("".concat(e.target.dataset.orientation)),setTimeout((function(){var e=t._map.getBounds();t._map.invalidateSize(),t._map.fitBounds(e)}),200)}},{key:"_updateDarkTheme",value:function(e){e.target.checked?(document.body.classList.remove("light-theme"),document.body.classList.add("dark-theme")):(document.body.classList.remove("dark-theme"),document.body.classList.add("light-theme"))}},{key:"_updateTextPosition",value:function(e){e.target.checked?document.getElementById("map-output").classList.add("txt-reverse"):document.getElementById("map-output").classList.remove("txt-reverse")}},{key:"_updateMapStyle",value:function(e){for(var t="",n=document.getElementById("map-style"),o=0;o<n.children.length;++o)if(n.children[o].classList.contains("selected")){t=n.children[o].dataset.style,n.children[o].classList.remove("selected");break}e.target.classList.add("selected"),document.getElementById("map-output").classList.remove("".concat(t,"-style")),document.getElementById("map-output").classList.add("".concat(e.target.dataset.style,"-style"))}},{key:"_applyTexts",value:function(e){document.getElementById("title").innerHTML=document.getElementById("user-title").value,document.getElementById("subtitle").innerHTML=document.getElementById("user-subtitle").value,document.getElementById("comment").innerHTML=document.getElementById("user-comment").value,e&&e.target&&"user-comment"===e.target.id&&(this._commentEdited=!0)}},{key:"_textColorEdit",value:function(e){document.getElementById(e.target.dataset.type).style.color=e.target.value}},{key:"_updateCommentLabel",value:function(){if(!this._commentEdited){var e=this._map.getCenter();document.getElementById("comment").innerHTML="".concat(this.precisionRound(e.lat,3),"°N / ").concat(this.precisionRound(e.lng,3),"° E")}}},{key:"_updateDimensionLabel",value:function(e){var t=e.target.previousElementSibling,n="7";e.target.value>4961?n="2":e.target.value>3508?n="3":e.target.value>2480?n="4":e.target.value>1754?n="5":e.target.value>1241&&(n="6");var o=this.precisionRound(29.7*e.target.value/21,0);e.target.dataset.height=o,document.getElementById("map-output").classList.contains("horizontal")?t.innerHTML="".concat(this._nls.export.dimension," : ").concat(o," x ").concat(e.target.value," — A").concat(n," ").concat(this._nls.export.at," 300dpi"):t.innerHTML="".concat(this._nls.export.dimension," : ").concat(e.target.value," x ").concat(o," — A").concat(n," ").concat(this._nls.export.at," 300dpi")}},{key:"_searchMatch",value:function(e){this._map.setView(e.latlng)}},{key:"_updateLang",value:function(e){localStorage.setItem("lang",e.target.value),window.location.reload()}},{key:"_download",value:function(){var e=this;document.getElementById("print-overlay").style.zIndex=99,document.getElementById("print-overlay").style.opacity=1,document.getElementById("map-output").style.transition="none",setTimeout((function(){var t=document.getElementById("image-width").value,n=t/600;if(document.getElementById("map-output").classList.contains("horizontal")){var o=document.getElementById("image-width").dataset.height;n=o/600,t=o}var l=e._map.getBounds();e._dlPrepareMap(t,n,l),1===n&&(e._tilesLoaded=!0),e._intervalId=setInterval(e._dlPerformMapPrint.bind(e,l),1e3)}),200)}},{key:"_dlPrepareMap",value:function(e,t,n){var o=this;document.getElementById("print-status").innerHTML=this._nls.download.stylePrep,document.getElementById("print-progress").style.width="10%",document.querySelector(".leaflet-top.leaflet-left").style.display="none",document.querySelector(".leaflet-top.leaflet-right").style.display="none";var l=parseInt(window.getComputedStyle(document.getElementById("map-output")).getPropertyValue("--padding").replace("rem","")),a=parseInt(window.getComputedStyle(document.getElementById("map-output")).getPropertyValue("--thick-border").replace("px","")),r=parseInt(window.getComputedStyle(document.getElementById("map-output")).getPropertyValue("--small-border").replace("px",""));document.getElementById("map-output").style.setProperty("--padding","".concat(l*t,"rem")),document.getElementById("map-output").style.setProperty("--thick-border","".concat(a*t,"px")),document.getElementById("map-output").style.setProperty("--small-border","".concat(r*t,"px")),document.body.style.fontSize="".concat(1.2*t,"rem"),this._tilesLoaded=!1,document.getElementById("map-output").classList.contains("horizontal")?document.getElementById("map-output").style.height="".concat(e,"px"):document.getElementById("map-output").style.width="".concat(e,"px"),document.body.clientWidth<1150&&(document.querySelector(".user-text-wrapper").style.fontSize="inherit"),document.getElementById("map-output").style.position="absolute",document.getElementById("map-output").classList.remove("shadow"),document.getElementById("map-output").style.boxShadow="none",requestAnimationFrame((function(){o._map.invalidateSize(),o._map.fitBounds(n),document.getElementById("print-status").innerHTML=o._nls.download.tileLoad,document.getElementById("print-progress").style.width="25%"}))}},{key:"_dlPerformMapPrint",value:function(e){var t=this;!0===this._tilesLoaded&&(document.getElementById("print-status").innerHTML=this._nls.download.printStart,document.getElementById("print-progress").style.width="66%",clearInterval(this._intervalId),this._tilesLoaded=!1,requestAnimationFrame((function(){window.html2canvas(document.getElementById("map-output"),{proxy:"/proxy",logging:s,width:document.getElementById("map-output").offsetWidth,height:document.getElementById("map-output").offsetHeight,imageTimeout:0,onclone:function(){document.getElementById("print-status").innerHTML=t._nls.download.outputFile,document.getElementById("print-progress").style.width="72%"}}).then(t._dlMap.bind(t,e)).catch((function(n){console.error(n),t._dlRestoreMap(e)}))})))}},{key:"_dlMap",value:function(e,t){document.getElementById("print-status").innerHTML=this._nls.download.saveToDisk,document.getElementById("print-progress").style.width="88%";var n=this.getOutputFileType(),o=document.createElement("A");if(o.download="".concat(document.getElementById("title").innerHTML,".").concat(n.extension),"pdf"===n.type){var l=document.getElementById("image-width-label").innerHTML.split("—")[1].replace(" ","").substring(0,2),a=new d({orientation:document.getElementById("map-output").classList.contains("horizontal")?"landscape":"portrait",format:l,precision:32}),r=a.internal.pageSize.getWidth(),i=a.internal.pageSize.getHeight();a.addImage(t.toDataURL("image/png",1),"PNG",0,0,r,i),a.save("".concat(document.getElementById("title").innerHTML,".pdf"))}else o.href=t.toDataURL("image/".concat(n.type),1),o.click();this._dlRestoreMap(e)}},{key:"_dlRestoreMap",value:function(e){var t=this;document.getElementById("print-status").innerHTML=this._nls.download.restoreMap,document.getElementById("print-progress").style.width="100%",document.querySelector(".leaflet-top.leaflet-left").style.display="inherit",document.querySelector(".leaflet-top.leaflet-right").style.display="inherit",document.body.style.fontSize="1.2rem",document.body.clientWidth<1150&&(document.querySelector(".user-text-wrapper").style.fontSize="50%"),document.getElementById("map-output").style="",document.getElementById("map-output").classList.add("shadow"),document.getElementById("print-overlay").style.opacity=0,setTimeout((function(){document.getElementById("print-overlay").style.zIndex=-1,t._map.invalidateSize(),t._map.fitBounds(e),document.getElementById("map-output").style.transition="all .2s",document.getElementById("print-progress").style.width="0"}),200)}},{key:"_themeEditModal",value:function(e){var t=this;e.preventDefault(),this._fetchModal("themeedit").then((function(e){var n=function(){document.getElementById("light-bg-color").value=t._cssTheme.lbg,document.getElementById("light-txt-color").value=t._cssTheme.ltxt,document.getElementById("light-txt-alt-color").value=t._cssTheme.lcom,document.getElementById("dark-bg-color").value=t._cssTheme.dbg,document.getElementById("dark-txt-color").value=t._cssTheme.dtxt,document.getElementById("dark-txt-alt-color").value=t._cssTheme.dcom},o=function(e){document.querySelector(":root").style.setProperty("--color-".concat(e.target.dataset.key),e.target.value),t.updateThemeColorInternal()};e.querySelector("#light-bg-color").addEventListener("input",o),e.querySelector("#light-txt-color").addEventListener("input",o),e.querySelector("#light-txt-alt-color").addEventListener("input",o),e.querySelector("#dark-bg-color").addEventListener("input",o),e.querySelector("#dark-txt-color").addEventListener("input",o),e.querySelector("#dark-txt-alt-color").addEventListener("input",o),t.updateThemeColorInternal(),e.querySelector("#close").addEventListener("click",t._closeModal.bind(t,null,!0)),e.querySelector("#reset").addEventListener("click",(function(){t._cssTheme.lbg="#FFFFFE",t._cssTheme.ltxt="#000001",t._cssTheme.lcom="#999998",t._cssTheme.dbg="#000001",t._cssTheme.dtxt="#FFFFFE",t._cssTheme.dcom="#999998",t.applyThemeColor(),n()})),document.getElementById("modal-overlay").appendChild(e),document.getElementById("modal-overlay").style.display="flex",setTimeout((function(){return document.getElementById("modal-overlay").style.opacity=1}),50),requestAnimationFrame((function(){t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_TITLE}}",t._nls.theme.title),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_LIGHT_THEME}}",t._nls.theme.lightTheme),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_DARK_THEME}}",t._nls.theme.darkTheme),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_BG_LIGHT}}",t._nls.theme.bg),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_TXT_LIGHT}}",t._nls.theme.txt),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_TXTALT_LIGHT}}",t._nls.theme.txtAlt),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_BG_DARK}}",t._nls.theme.bg),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_TXT_DARK}}",t._nls.theme.txt),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_TXTALT_DARK}}",t._nls.theme.txtAlt),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_RESET}}",t._nls.theme.default),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_CLOSE}}",t._nls.action.close),n()}))}))}},{key:"_creditModal",value:function(e){var t=this;e.preventDefault(),this._fetchModal("credits").then((function(e){document.getElementById("modal-overlay").appendChild(e),document.getElementById("modal-overlay").style.display="flex",setTimeout((function(){return document.getElementById("modal-overlay").style.opacity=1}),50),requestAnimationFrame((function(){t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_TITLE}}",t._nls.title),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_LINE1}}",t._nls.credit.line1),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_LINE2}}",t._nls.credit.line2),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_LINE3}}",t._nls.credit.line3),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_LINE4}}",t._nls.credit.line4),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_LANG}}",t._nls.credit.lang),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_FR}}",t._nls.credit.fr),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_EN}}",t._nls.credit.en),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_ES}}",t._nls.credit.es),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_DE}}",t._nls.credit.de),t.replaceString(document.getElementById("modal-overlay"),"{{MODAL_CLOSE}}",t._nls.action.close),document.getElementById("lang").value=t._lang,document.getElementById("lang").addEventListener("change",t._updateLang.bind(t)),document.getElementById("close").addEventListener("click",t._closeModal.bind(t,null,!0))}))}))}},{key:"_fetchModal",value:function(e){return new Promise((function(t){fetch("assets/html/".concat(e,".html")).then((function(e){e.text().then((function(e){t(document.createRange().createContextualFragment(e))}))}))}))}},{key:"_closeModal",value:function(e,t){!0!==t&&"modal-overlay"!==e.target.id&&-1===e.target.id.indexOf("close")||(document.getElementById("modal-overlay").style.opacity=0,setTimeout((function(){document.getElementById("modal-overlay").style.display="none",document.getElementById("modal-overlay").innerHTML=""}),300))}},{key:"getOutputFileType",value:function(){var e={extension:"png",type:"png"};return Array.from(document.getElementById("image-type").elements).forEach((function(t){!0===t.checked&&(e.extension=t.dataset.extension,e.type=t.dataset.type)})),e}},{key:"precisionRound",value:function(e,t){var n=Math.pow(10,t||0);return Math.round(e*n)/n}},{key:"updateThemeColorInternal",value:function(){this._cssTheme={lbg:window.getComputedStyle(document.querySelector(":root")).getPropertyValue("--color-l-bg"),ltxt:window.getComputedStyle(document.querySelector(":root")).getPropertyValue("--color-l-txt"),lcom:window.getComputedStyle(document.querySelector(":root")).getPropertyValue("--color-l-txt-alt"),dbg:window.getComputedStyle(document.querySelector(":root")).getPropertyValue("--color-d-bg"),dtxt:window.getComputedStyle(document.querySelector(":root")).getPropertyValue("--color-d-txt"),dcom:window.getComputedStyle(document.querySelector(":root")).getPropertyValue("--color-d-txt-alt")},localStorage.setItem("theme",JSON.stringify(this._cssTheme))}},{key:"applyThemeColor",value:function(){document.querySelector(":root").style.setProperty("--color-l-bg",this._cssTheme.lbg),document.querySelector(":root").style.setProperty("--color-l-txt",this._cssTheme.ltxt),document.querySelector(":root").style.setProperty("--color-l-txt-alt",this._cssTheme.lcom),document.querySelector(":root").style.setProperty("--color-d-bg",this._cssTheme.dbg),document.querySelector(":root").style.setProperty("--color-d-txt",this._cssTheme.dtxt),document.querySelector(":root").style.setProperty("--color-d-txt-alt",this._cssTheme.dcom),this.updateThemeColorInternal()}},{key:"replaceString",value:function(e,t,n){e.innerHTML=e.innerHTML.replace(t,n)}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()}(),window.MesseMap=o.default}();